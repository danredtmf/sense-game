[gd_scene load_steps=13 format=2]

[ext_resource path="res://levels/models/textures/note.png" type="Texture" id=1]
[ext_resource path="res://sources/themes/font_size/main_26.tres" type="DynamicFont" id=2]
[ext_resource path="res://sources/themes/font_size/main_62.tres" type="DynamicFont" id=3]
[ext_resource path="res://sources/themes/button/normal.tres" type="StyleBox" id=4]
[ext_resource path="res://sources/themes/button/hover.tres" type="StyleBox" id=5]
[ext_resource path="res://sources/themes/button/pressed.tres" type="StyleBox" id=6]
[ext_resource path="res://sources/themes/button/disabled.tres" type="StyleBox" id=7]
[ext_resource path="res://sources/themes/font_size/letter_26.tres" type="DynamicFont" id=8]

[sub_resource type="GDScript" id=2]
script/source = "extends Control

var note_id = 0
var note_name = ''
var note_text = ''

func _ready():
	get_tree().paused = true
	
	$close_btn.text = tr('close')
	
	Input.set_mouse_mode(Input.MOUSE_MODE_VISIBLE)
	
	var list = Data.open_note(note_id)
	note_name = list[0]
	note_text = list[1]
	
	$name.text = note_name
	$pic/text.text = note_text

func _on_close_btn_pressed():
	Input.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)
	get_tree().paused = false
	queue_free()
"

[sub_resource type="Shader" id=7]
code = "shader_type canvas_item;

uniform float blur_amount : hint_range(-2.0, 10.0);
uniform float mix_amount : hint_range(0.0, 1.0);
uniform vec4 color_over : hint_color;

void fragment() {
	vec4 blurred = textureLod(SCREEN_TEXTURE, SCREEN_UV, blur_amount);
	vec4 fin = mix(blurred, color_over, mix_amount);
	COLOR = fin;
}"

[sub_resource type="ShaderMaterial" id=8]
shader = SubResource( 7 )
shader_param/blur_amount = 2.0
shader_param/mix_amount = 0.2
shader_param/color_over = null

[sub_resource type="StyleBoxEmpty" id=6]

[node name="viewing_note" type="Control"]
pause_mode = 2
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 2 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="back" type="ColorRect" parent="."]
material = SubResource( 8 )
anchor_right = 1.0
anchor_bottom = 1.0
color = Color( 0.156863, 0.156863, 0.156863, 0.392157 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="pic" type="TextureRect" parent="."]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -234.0
margin_top = -259.0
margin_right = 234.0
margin_bottom = 339.0
texture = ExtResource( 1 )
expand = true
__meta__ = {
"_edit_use_anchors_": false
}

[node name="text" type="RichTextLabel" parent="pic"]
anchor_left = 0.014698
anchor_top = 0.0104428
anchor_right = 0.867718
anchor_bottom = 0.989557
margin_left = 0.121325
margin_top = -0.244779
margin_right = 0.121338
margin_bottom = -0.244873
custom_colors/default_color = Color( 0.0823529, 0.0313726, 0.345098, 1 )
custom_fonts/normal_font = ExtResource( 8 )
__meta__ = {
"_edit_use_anchors_": true
}

[node name="name" type="Label" parent="."]
anchor_right = 1.0
margin_bottom = 14.0
custom_fonts/font = ExtResource( 3 )
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="close_btn" type="Button" parent="."]
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = -266.0
margin_top = -96.0
margin_right = -16.0
margin_bottom = -16.0
custom_fonts/font = ExtResource( 2 )
custom_styles/hover = ExtResource( 5 )
custom_styles/pressed = ExtResource( 6 )
custom_styles/focus = SubResource( 6 )
custom_styles/disabled = ExtResource( 7 )
custom_styles/normal = ExtResource( 4 )
text = "Close"
__meta__ = {
"_edit_use_anchors_": false
}

[connection signal="pressed" from="close_btn" to="." method="_on_close_btn_pressed"]
